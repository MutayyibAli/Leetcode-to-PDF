<div class='cpp-solution'><h2>My solutions in 3 languages with Stack -- Votes: 1013</h2><p>I use Stack to store directed left children from root.<br />
When next() be called, I just pop one element and process its right child as new root.<br />
The code is pretty straightforward.</p>
<p>So this can satisfy O(h) memory, hasNext() in O(1) time,<br />
But next() is O(h) time.</p>
<p>I can't find a solution that can satisfy both next() in O(1) time, space in O(h).</p>
<p>Java:</p>
<div class="codehilite"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">BSTIterator</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">BSTIterator</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return whether we have a next smallest number */</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">boolean</span><span class="w"> </span><span class="n">hasNext</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">!</span><span class="n">stack</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return the next smallest number */</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">next</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">TreeNode</span><span class="w"> </span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="p">.</span><span class="nf">right</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">),</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="nf">left</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<p>C++:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">BSTIterator</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">myStack</span><span class="p">;</span>
<span class="k">public</span><span class="err">:</span>
<span class="w">    </span><span class="n">BSTIterator</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return whether we have a next smallest number */</span>
<span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">hasNext</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">!</span><span class="n">myStack</span><span class="p">.</span><span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return the next smallest number */</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="k">next</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myStack</span><span class="p">.</span><span class="k">top</span><span class="p">();</span>
<span class="w">        </span><span class="n">myStack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="o">-&gt;</span><span class="nf">right</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="nl">private</span><span class="p">:</span>
<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">myStack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">),</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="nf">left</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>
</code></pre></div>

<p>Python:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">BSTIterator</span><span class="p">:</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@param</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">binary</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="n">tree</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">node</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">()</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">smallest</span><span class="w"> </span><span class="n">number</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">hasNext</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@return</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">integer</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">smallest</span><span class="w"> </span><span class="n">number</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">next</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="p">.</span><span class="nf">right</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="p">.</span><span class="n">val</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="nf">left</span>
</code></pre></div></div>


<div class='python-solution'><h2>My solutions in 3 languages with Stack -- Votes: 1013</h2><p>I use Stack to store directed left children from root.<br />
When next() be called, I just pop one element and process its right child as new root.<br />
The code is pretty straightforward.</p>
<p>So this can satisfy O(h) memory, hasNext() in O(1) time,<br />
But next() is O(h) time.</p>
<p>I can't find a solution that can satisfy both next() in O(1) time, space in O(h).</p>
<p>Java:</p>
<div class="codehilite"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">BSTIterator</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="n">BSTIterator</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return whether we have a next smallest number */</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">boolean</span><span class="w"> </span><span class="n">hasNext</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">!</span><span class="n">stack</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return the next smallest number */</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="k">next</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">TreeNode</span><span class="w"> </span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="p">.</span><span class="nf">right</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="p">.</span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">private</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">;</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">),</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="nf">left</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<p>C++:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">BSTIterator</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">stack</span><span class="o">&lt;</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="n">myStack</span><span class="p">;</span>
<span class="k">public</span><span class="err">:</span>
<span class="w">    </span><span class="n">BSTIterator</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return whether we have a next smallest number */</span>
<span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">hasNext</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">!</span><span class="n">myStack</span><span class="p">.</span><span class="n">empty</span><span class="p">();</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="cm">/** @return the next smallest number */</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="k">next</span><span class="p">()</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myStack</span><span class="p">.</span><span class="k">top</span><span class="p">();</span>
<span class="w">        </span><span class="n">myStack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="o">-&gt;</span><span class="nf">right</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="nl">private</span><span class="p">:</span>
<span class="w">    </span><span class="n">void</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">TreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(;</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">myStack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">),</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="nf">left</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span><span class="p">;</span>
</code></pre></div>

<p>Python:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">BSTIterator</span><span class="p">:</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@param</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">binary</span><span class="w"> </span><span class="k">search</span><span class="w"> </span><span class="n">tree</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">node</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">()</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">boolean</span><span class="p">,</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">smallest</span><span class="w"> </span><span class="n">number</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">hasNext</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nv">@return</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">integer</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">smallest</span><span class="w"> </span><span class="n">number</span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">next</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">tmpNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">pushAll</span><span class="p">(</span><span class="n">tmpNode</span><span class="p">.</span><span class="nf">right</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tmpNode</span><span class="p">.</span><span class="n">val</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">pushAll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">stack</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="nf">left</span>
</code></pre></div></div><p style="page-break-before: always" ></p>