<div class='cpp-solution'><h2>[C++] Worst to Best Solution Explained (for dummies like me) -- Votes: 407</h2><p><strong>Approach 1</strong> (Recursion+Memo): [199/200 CASES PASSED, TLE]<br />
The most intuitive approach is to explore all choices, if we haven't bought a stock yet, we either buy it or skip it. Similarly we have two choices for selling also. We also keep a track of number of transactions completed so that we stop after 2 transactions. This way we end up exploring all possibilties and return the optimal combination. Here's the code:</p>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">memo</span><span class="p">;</span>
<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="nc">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">isBuy</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">prices</span><span class="p">.</span><span class="k">size</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">     </span><span class="o">//</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">completed</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">string</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">to_string</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">to_string</span><span class="p">(</span><span class="n">isBuy</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">to_string</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">memo</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="k">key</span><span class="p">)</span><span class="o">!=</span><span class="n">memo</span><span class="p">.</span><span class="k">end</span><span class="p">())</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">memo</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">isBuy</span><span class="p">)</span><span class="err">{</span><span class="w">                           </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isBuy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">choice</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">purchase</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stock</span>
<span class="w">            </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w">                       </span><span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">buy</span>
<span class="w">            </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">           </span><span class="o">//</span><span class="w"> </span><span class="n">buy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span>
<span class="w">        </span><span class="err">}</span><span class="w">  </span>
<span class="w">        </span><span class="k">else</span><span class="err">{</span><span class="w">                                </span><span class="o">//</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isBuy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">sell</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">bought</span>
<span class="w">            </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w">                       </span><span class="o">//</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">sell</span>
<span class="w">            </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span><span class="w">       </span><span class="o">//</span><span class="w"> </span><span class="n">sell</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">profit</span>
<span class="w">        </span><span class="err">}</span><span class="w">   </span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">memo</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">choice</span><span class="w"> </span><span class="n">among</span><span class="w"> </span><span class="n">trading</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">skipping</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="nc">int</span><span class="w"> </span><span class="n">maxProfit</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="nc">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">prices</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">profit</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="err">}</span>
</code></pre></div>

<hr />
<p><strong>Approach 2</strong> (Setting break points, O(N) TIME and SPACE): [ACCEPTED]<br />
The idea here is to set a break point before which we have completed the first transaction and will complete the second transaction in the remaining days. There are N -1 such break points. Instead of explicitly setting break points and computing the profit for the left part and right part, we precompute the profit for every break point. Starting from the left, for every element we check the least price in the array to its left and check if the selling at current price can make us a larger profit than skipping it. Similarly, starting from the right, for every element, we check the array to the right of it and find an element larger to the current; and check if buying at current price makes us a larger profit than skipping it. This will be clear with the example mentioned below:</p>
<div class="codehilite"><pre><span></span><code><span class="nc">int</span><span class="w"> </span><span class="n">maxProfit</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="nc">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">prices</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="err">!</span><span class="n">prices</span><span class="p">.</span><span class="k">size</span><span class="p">())</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="p">.</span><span class="k">size</span><span class="p">();</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="nf">left</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nf">right</span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">leftmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">rightmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">n-1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">maxprofit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="nf">left</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nf">right</span><span class="o">[</span><span class="n">n - 1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                                     </span><span class="o">//</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">profit</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">element</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="c1">--){</span>
<span class="w">            </span><span class="n">leftmin</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">leftmin</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span><span class="w">                            </span><span class="o">//</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">minimum</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="n">till</span><span class="w"> </span><span class="n">now</span>
<span class="w">            </span><span class="nf">left</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">left</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">leftmin</span><span class="p">);</span><span class="w">              </span><span class="o">//</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">selling</span><span class="w"> </span><span class="n">today</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="p">(</span><span class="n">previous</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="n">profit</span><span class="p">)</span>
<span class="w">            </span><span class="n">rightmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">rightmax</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">);</span><span class="w">                           </span><span class="o">//</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">right</span>
<span class="w">            </span><span class="nf">right</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="nf">right</span><span class="o">[</span><span class="n">j + 1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">rightmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">);</span><span class="w">            </span><span class="o">//</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">buying</span><span class="w"> </span><span class="n">today</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">skipping</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="err">{</span>
<span class="w">            </span><span class="n">maxprofit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">maxprofit</span><span class="p">,</span><span class="w"> </span><span class="nf">left</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">right</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">maxprofit</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nl">EG</span><span class="p">:</span><span class="w"> </span><span class="n">PRICES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">3,3,5,0,0,3,1,4</span><span class="o">]</span>
<span class="w">    </span><span class="o">//</span><span class="w">     </span><span class="nf">LEFT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">0,0,2,2,2,2,2,3</span><span class="o">]</span>
<span class="w">    </span><span class="o">//</span><span class="w">     </span><span class="nf">RIGHT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">2,2,4,4,4,1,0,0</span><span class="o">]</span>
<span class="w">    </span><span class="o">//</span><span class="w">     </span><span class="nf">SUM</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">2,2,6,6,6,3,2,3</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="o">//</span><span class="w">     </span><span class="nf">MAX</span><span class="w"> </span><span class="n">PROFIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
</code></pre></div>

<hr />
<p><strong>Approach 3</strong> (O(N) time O(1) space) [ACCEPTED]<br />
Suppose you make some profit <strong>p1</strong> by doing your first transaction in the stock market. Now you are excited to purchase another stock to earn more profit. Suppose the price of the second stock you aim to buy is <strong>x</strong>. Now, for you, the net effective price that you are spending from your pocket for this stock will be <strong>x-p1</strong>, because you already have <strong>p1</strong> bucks in your hand. Now, if you sell the second stock at price <strong>y</strong> your net profit <strong>p2</strong> will be <strong>p2 = y - (x-p1)</strong>. You have to do nothing but maximize this profit <strong>p2</strong>. Here's the code:</p>
<div class="codehilite"><pre><span></span><code><span class="nc">int</span><span class="w"> </span><span class="n">maxProfit</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="nc">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">prices</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="err">!</span><span class="n">prices</span><span class="p">.</span><span class="k">size</span><span class="p">())</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">buy1</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">profit1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MIN</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">buy2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MAX</span><span class="p">;</span>
<span class="w">        </span><span class="nc">int</span><span class="w"> </span><span class="n">profit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INT_MIN</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">prices</span><span class="p">.</span><span class="k">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="err">{</span>
<span class="w">            </span><span class="n">buy1</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">buy1</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="n">profit1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">profit1</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">buy1</span><span class="p">);</span>
<span class="w">            </span><span class="n">buy2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">buy2</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">profit1</span><span class="p">);</span>
<span class="w">            </span><span class="n">profit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">profit2</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">buy2</span><span class="p">);</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">profit2</span><span class="p">;</span>
<span class="w">    </span><span class="err">}</span>
</code></pre></div>

<p>Hope it helps! Please upvote if you understood.</p></div>


<div class='python-solution'><h2>Python DP solution, 120ms -- Votes: 146</h2><p>Two passes through the list, O(n) time, O(n) space:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">maxProfit</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">prices</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">forward</span><span class="w"> </span><span class="n">traversal</span><span class="p">,</span><span class="w"> </span><span class="n">profits</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="n">profit</span><span class="w"> </span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="nf">day</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="k">transaction</span>
<span class="w">    </span><span class="n">profits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">max_profit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">current_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">prices</span><span class="p">:</span>
<span class="w">        </span><span class="n">current_min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">current_min</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="p">)</span>
<span class="w">        </span><span class="n">max_profit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">max_profit</span><span class="p">,</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">current_min</span><span class="p">)</span>
<span class="w">        </span><span class="n">profits</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_profit</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">backward</span><span class="w"> </span><span class="n">traversal</span><span class="p">,</span><span class="w"> </span><span class="n">max_profit</span><span class="w"> </span><span class="n">records</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="n">profit</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ith</span><span class="w"> </span><span class="nf">day</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span>
<span class="w">    </span><span class="n">total_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">    </span>
<span class="w">    </span><span class="n">max_profit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">current_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="n">current_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">current_max</span><span class="p">,</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span>
<span class="w">        </span><span class="n">max_profit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">max_profit</span><span class="p">,</span><span class="w"> </span><span class="n">current_max</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prices</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span>
<span class="w">        </span><span class="n">total_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">total_max</span><span class="p">,</span><span class="w"> </span><span class="n">max_profit</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">profits</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">total_max</span>
</code></pre></div></div><p style="page-break-before: always" ></p>