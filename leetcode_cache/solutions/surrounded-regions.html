<div class='cpp-solution'><h4>A really simple and readable C++ solution\uff0conly cost 12ms [Votes: 514]</h4><ul>
<li>
<p>First, check the four border of the matrix. If there is a element is
   'O', alter it and all its neighbor 'O' elements to '1'.</p>
</li>
<li>
<p>Then ,alter all the 'O' to 'X'</p>
</li>
<li>At last,alter all the '1' to 'O'</li>
</ul>
<p>For example:</p>
<pre><code>         X X X X           X X X X             X X X X
         X X O X  -&gt;       X X O X    -&gt;       X X X X
         X O X X           X 1 X X             X O X X
         X O X X           X 1 X X             X O X X


class Solution {
public:
    void solve(vector&lt;vector&lt;char&gt;&gt;&amp; board) {
        int i,j;
        int row=board.size();
        if(!row)
            return;
        int col=board[0].size();

        for(i=0;i&lt;row;i++){
            check(board,i,0,row,col);
            if(col&gt;1)
                check(board,i,col-1,row,col);
        }
        for(j=1;j+1&lt;col;j++){
            check(board,0,j,row,col);
            if(row&gt;1)
                check(board,row-1,j,row,col);
        }
        for(i=0;i&lt;row;i++)
            for(j=0;j&lt;col;j++)
                if(board[i][j]=='O')
                    board[i][j]='X';
        for(i=0;i&lt;row;i++)
            for(j=0;j&lt;col;j++)
                if(board[i][j]=='1')
                    board[i][j]='O';
    }
    void check(vector&lt;vector&lt;char&gt; &gt;&amp;vec,int i,int j,int row,int col){
        if(vec[i][j]=='O'){
            vec[i][j]='1';
            if(i&gt;1)
                check(vec,i-1,j,row,col);
            if(j&gt;1)
                check(vec,i,j-1,row,col);
            if(i+1&lt;row)
                check(vec,i+1,j,row,col);
            if(j+1&lt;col)
                check(vec,i,j+1,row,col);
        }
    }
};
</code></pre></div><div class='python-solution'><h4>9 lines, Python 148 ms [Votes: 278]</h4><p>Phase 1: "Save" every O-region touching the border, changing its cells to 'S'.<br />
Phase 2: Change every 'S' on the board to 'O' and everything else to 'X'.</p>
<pre><code>def solve(self, board):
    if not any(board): return

    m, n = len(board), len(board[0])
    save = [ij for k in range(m+n) for ij in ((0, k), (m-1, k), (k, 0), (k, n-1))]
    while save:
        i, j = save.pop()
        if 0 &lt;= i &lt; m and 0 &lt;= j &lt; n and board[i][j] == 'O':
            board[i][j] = 'S'
            save += (i, j-1), (i, j+1), (i-1, j), (i+1, j)

    board[:] = [['XO'[c == 'S'] for c in row] for row in board]
</code></pre>
<p>In case you don't like my last line, you could do this instead:</p>
<pre><code>    for row in board:
        for i, c in enumerate(row):
            row[i] = 'XO'[c == 'S']
</code></pre></div>